
# vim-cheatkey

一个轻量级的 Vim 插件，允许用户为快捷键绑定添加中文描述，并随时通过一个优雅的面板查看，帮助您记忆和发现所有自定义的键位。

## 核心问题

Vim 的强大在于其可定制性，但随着配置的增长和插件的增多，我们往往会忘记自己设置的或插件提供的快捷键。反复打开 `.vimrc` 文件查找不仅效率低下，也打断了心流。`vim-cheatkey` 旨在解决这一痛点。

## 核心功能

1.  **自定义快捷键文档**: 提供一个简单的命令，在创建快捷键的同时为其附加一段描述。
2.  **快捷键面板**: 通过一个命令，弹出一个窗口，清晰地列出所有已注册的快捷键及其描述。
3.  **模式支持**: 支持为不同的 Vim 模式 (Normal, Visual, Insert 等) 定义快捷键。
4.  **轻量与快速**: 插件本身逻辑简单，不依赖任何重型库，确保对 Vim 启动速度和性能影响最小。
5.  **易于配置**: 只需几个简单的命令即可在您的 `.vimrc` 中完成配置。

## 用户接口与命令

### 1. 定义快捷键

提供一个全局命令 `:CheatKey` 来替代原生的 `:map` 系列命令。

**格式**:
```vim
CheatKey <mode> <keys> <command> "description"
```

**参数说明**:
- `<mode>`: 快捷键生效的模式，如 `n`, `v`, `i` 等。
- `<keys>`: 具体的键位，如 `<F5>`, `<leader>f`。
- `<command>`: 该键位要执行的命令，如 `:NERDTreeToggle<CR>`。
- `"description"`: 用双引号包裹的中文（或任何语言）描述。

**示例**:
```vim
CheatKey n <F5> :NERDTreeToggle<CR> "切换文件浏览器"
CheatKey n <leader>s :w<CR> "保存当前文件"
```

### 2. 查看快捷键面板

提供一个全局命令 `:CheatKeyPanel` 来打开面板。

**命令**:
```vim
:CheatKeyPanel
```

**面板特性**:
- 在一个新的浮动窗口或分割窗口中显示。
- 格式化输出，包含 `键位`, `模式`, `描述` 三列，对齐整齐。
- 面板为只读，不可修改。
- 在面板中按 `q` 键可快速关闭。

## 配置与使用

用户需要在其 `.vimrc` 文件中进行如下配置：

1.  **安装插件** (以 `vim-plug` 为例):
    ```vim
    Plug 'wu9o/vim-cheatkey'
    ```

2.  **定义快捷键**:
    使用 `:CheatKey` 命令定义所有希望被追踪的快捷键。

3.  **设置面板触发键**:
    为了方便使用，用户应为 `:CheatKeyPanel` 命令自身也绑定一个快捷键。
    ```vim
    " 推荐使用 <leader>? 或 <leader>h (h for help)
    nmap <silent> <leader>? :CheatKeyPanel<CR>
    ```

## 技术实现思路

- **`plugin/cheatkey.vim`**:
  - 定义 `:CheatKey` 和 `:CheatKeyPanel` 两个用户命令。
  - `:CheatKey` 命令负责解析用户输入的参数，并调用 `autoload` 中的核心注册函数。
- **`autoload/cheatkey.vim`**:
  - 维护一个全局或脚本本地的列表变量 (e.g., `s:keymap_registry`)，用于存储所有快捷键的信息（模式、键位、命令、描述）。
  - 提供 `cheatkey#register(...)` 函数，该函数执行真正的 `map` 命令，并将快捷键信息存入注册表中。
  - 提供 `cheatkey#show_panel()` 函数，该函数负责创建和管理面板窗口的显示逻辑，包括读取注册表、格式化内容、设置窗口属性和绑定关闭键。

## 未来扩展

- [ ] **分组功能**: 允许用户为快捷键分组，如 `[Git]`, `[文件操作]`，并在面板中分类展示。
- [ ] **模糊搜索**: 在面板中提供模糊搜索功能，快速过滤快捷键。
- [ ] **主题定制**: 允许用户自定义面板的颜色和样式。
